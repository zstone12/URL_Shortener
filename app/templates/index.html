<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="{{ url_for('static', filename='JS/jquery.js') }}"></script>
    <script src="{{ url_for('static', filename='JS/jquery.form.js') }}"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <title>Hello</title>
</head>
<body>
<form action="#" id="shorten_form" onsubmit='return false'>
    <input type="text" placeholder="请输入长网址" name="long_url">
    <button onclick="shorten_url()">缩短网址</button>
</form>


<form action="#" id="lengthen_form" onsubmit='return false'>
    <input type="text" placeholder="请输入短网址" name="short_url">
    <button onclick="lengthen_url()">还原网址</button>
</form>


<div id="result_div" style="width:25%;float:left;">
</div>

</body>
<script>
    function lengthen_url() {  //获取到按钮的点击事件
        var BASE_URL = 'localhost/';

        $.ajax({
            url: "/lengthen/", //请求地址
            type: "POST",       //请求类型
            data: $('#lengthen_form').serialize(),
            success: function (data) {
                var s = document.createElement("div");
                var p = document.createElement("p");
                if (data.status) {
                    alert('您查询的短网址不存在');
                } else {
                    p.innerText = "原网址: " + data.long;
                    s.append(p);
                    $('#result_div').empty();
                    $('#result_div').append(s);
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            }
        })
    }
</script>
<script>
    function shorten_url() {  //获取到按钮的点击事件
        var BASE_URL = 'localhost/';
        $.ajax({
            url: "/shorten/", //请求地址
            type: "POST",       //请求类型
            data: $('#shorten_form').serialize(),
            success: function (data) {
                {#var data1 = JSON.parse(data);#}
                var s = document.createElement("div");
                var p = document.createElement("p");
                p.innerText = "原网址: " + data.long;

                var p2 = document.createElement("p");
                p2.innerText = "短网址: " + BASE_URL + data.short;
                s.append(p2);
                s.append(p);
                $('#result_div').empty();
                $('#result_div').append(s);


            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            }
        })
    }
</script>
</html>